{% extends 'base.html' %}
{% load static %}

{% block title %}Dashboard - Task Manager{% endblock %}

{% block content %}
<div class="dashboard-container">
    <!-- Dashboard Header -->
    <div class="dashboard-header">
        <h1>Dashboard</h1>
        <p class="dashboard-subtitle">Overview of your tasks and activities</p>
    </div>

    <!-- Stats Cards -->
    <div class="stats-grid">
        <!-- Total Tasks Card -->
        <div class="stat-card stat-card-total">
            <div class="stat-icon">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 11l3 3L22 4"></path>
                    <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
                </svg>
            </div>
            <div class="stat-content">
                <p class="stat-label">Total Tasks</p>
                <h2 class="stat-value" id="totalTasks">0</h2>
            </div>
        </div>

        <!-- Completed Tasks Card -->
        <div class="stat-card stat-card-completed">
            <div class="stat-icon">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 11. 08V12a10 10 0 1 1-5.93-9.14"></path>
                    <polyline points="22 4 12 14. 01 9 11.01"></polyline>
                </svg>
            </div>
            <div class="stat-content">
                <p class="stat-label">Completed</p>
                <h2 class="stat-value" id="completedTasks">0</h2>
            </div>
        </div>

        <!-- Pending Tasks Card -->
        <div class="stat-card stat-card-pending">
            <div class="stat-icon">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
            </div>
            <div class="stat-content">
                <p class="stat-label">Pending</p>
                <h2 class="stat-value" id="pendingTasks">0</h2>
            </div>
        </div>
    </div>

    <!-- Progress Section -->
    <div class="progress-section">
        <div class="section-header">
            <h2>Task Progress</h2>
            <p class="completion-percentage" id="completionPercentage">0% Complete</p>
        </div>

        <!-- Progress Bar -->
        <div class="progress-bar-container">
            <div class="progress-bar" id="progressBar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>

        <!-- Progress Stats -->
        <div class="progress-stats">
            <div class="progress-stat">
                <span class="progress-stat-label">Completed</span>
                <span class="progress-stat-value" id="progressCompleted">0</span>
            </div>
            <div class="progress-stat">
                <span class="progress-stat-label">In Progress</span>
                <span class="progress-stat-value" id="progressInProgress">0</span>
            </div>
            <div class="progress-stat">
                <span class="progress-stat-label">Pending</span>
                <span class="progress-stat-value" id="progressPending">0</span>
            </div>
        </div>
    </div>

    <!-- Chart Section -->
    <div class="chart-section">
        <div class="section-header">
            <h2>Weekly Overview</h2>
        </div>

        <div class="chart-container">
            <div class="chart-bars" id="chartBars">
                <!-- Bars will be generated by JavaScript -->
            </div>
            <div class="chart-labels">
                <span>Mon</span>
                <span>Tue</span>
                <span>Wed</span>
                <span>Thu</span>
                <span>Fri</span>
                <span>Sat</span>
                <span>Sun</span>
            </div>
        </div>
    </div>

    <!-- Recent Activities -->
    <div class="activities-section">
        <div class="section-header">
            <h2>Recent Activities</h2>
        </div>

        <div class="activity-list" id="activityList">
            <!-- Activities will be generated by JavaScript -->
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Dashboard data (simulated - in real app, this would come from backend)
    const dashboardData = {
        totalTasks: 45,
        completedTasks:  32,
        pendingTasks:  13,
        weeklyData: [8, 12, 15, 10, 14, 9, 11],
        activities: [
            { title: 'Completed "Design Review"', time: '2 hours ago', type: 'completed' },
            { title: 'Added new task "Backend API"', time: '5 hours ago', type: 'added' },
            { title: 'Updated "Database Schema"', time: '1 day ago', type: 'updated' },
            { title: 'Completed "User Testing"', time: '2 days ago', type: 'completed' },
            { title: 'Added new task "Documentation"', time: '3 days ago', type: 'added' }
        ]
    };

    // Update stats
    function updateStats() {
        document.getElementById('totalTasks').textContent = dashboardData.totalTasks;
        document.getElementById('completedTasks').textContent = dashboardData.completedTasks;
        document.getElementById('pendingTasks').textContent = dashboardData.pendingTasks;
        
        // Animate numbers
        animateNumber('totalTasks', dashboardData. totalTasks);
        animateNumber('completedTasks', dashboardData.completedTasks);
        animateNumber('pendingTasks', dashboardData.pendingTasks);
    }

    // Animate number counting
    function animateNumber(elementId, target) {
        const element = document.getElementById(elementId);
        let current = 0;
        const increment = target / 30;
        const timer = setInterval(() => {
            current += increment;
            if (current >= target) {
                element.textContent = target;
                clearInterval(timer);
            } else {
                element.textContent = Math.floor(current);
            }
        }, 30);
    }

    // Update progress bar
    function updateProgress() {
        const percentage = Math.round((dashboardData.completedTasks / dashboardData.totalTasks) * 100);
        const progressFill = document.getElementById('progressFill');
        const completionPercentage = document.getElementById('completionPercentage');
        
        setTimeout(() => {
            progressFill.style.width = percentage + '%';
        }, 100);
        
        completionPercentage.textContent = percentage + '% Complete';
        
        document.getElementById('progressCompleted').textContent = dashboardData.completedTasks;
        document.getElementById('progressInProgress').textContent = Math.floor(dashboardData.pendingTasks / 2);
        document.getElementById('progressPending').textContent = dashboardData.pendingTasks;
    }

    // Generate chart
    function generateChart() {
        const chartBars = document.getElementById('chartBars');
        const maxValue = Math.max(...dashboardData.weeklyData);
        
        dashboardData.weeklyData.forEach((value, index) => {
            const barWrapper = document.createElement('div');
            barWrapper.className = 'chart-bar-wrapper';
            
            const bar = document.createElement('div');
            bar.className = 'chart-bar';
            const height = (value / maxValue) * 100;
            
            setTimeout(() => {
                bar.style.height = height + '%';
            }, 100 + (index * 50));
            
            const label = document.createElement('span');
            label.className = 'chart-value';
            label.textContent = value;
            
            barWrapper.appendChild(label);
            barWrapper.appendChild(bar);
            chartBars. appendChild(barWrapper);
        });
    }

    // Generate activities
    function generateActivities() {
        const activityList = document. getElementById('activityList');
        
        dashboardData.activities.forEach((activity, index) => {
            const activityItem = document. createElement('div');
            activityItem.className = 'activity-item';
            activityItem. style.animationDelay = (index * 0.1) + 's';
            
            const activityIcon = document.createElement('div');
            activityIcon.className = `activity-icon activity-icon-${activity.type}`;
            
            const activityContent = document.createElement('div');
            activityContent.className = 'activity-content';
            
            const activityTitle = document. createElement('p');
            activityTitle.className = 'activity-title';
            activityTitle.textContent = activity.title;
            
            const activityTime = document.createElement('span');
            activityTime.className = 'activity-time';
            activityTime.textContent = activity.time;
            
            activityContent.appendChild(activityTitle);
            activityContent.appendChild(activityTime);
            
            activityItem.appendChild(activityIcon);
            activityItem.appendChild(activityContent);
            
            activityList.appendChild(activityItem);
        });
    }

    // Initialize dashboard
    document.addEventListener('DOMContentLoaded', function() {
        updateStats();
        updateProgress();
        generateChart();
        generateActivities();
    });
</script>
{% endblock %}